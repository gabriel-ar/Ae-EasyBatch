# Templator
The After Effects Template Automator

This extension provides automation tools to batch render and generate projects based on datasets, either imported from CSV files or created on the extension.

## Development 
The extension uses Svelte as framework to render the UI side.

### To start development:

It is strongly suggested to use VS Code, since it is the only option given by Adobe for modern ExtendScript development.

- Clone the repository.
- Install the ExtendScript extension in VS Code.
- Run npm install to install the necessary packages.

- Set up your After Effects software for development (read the full guide [here](https://github.com/Adobe-CEP/CEP-Resources/blob/master/CEP_12.x/Documentation/CEP%2012%20HTML%20Extension%20Cookbook.md) )
    - MAC: Use the `debug_config.sh` script
    - WIN: Use `debug_config.bat`
- Create a symlink in the [folder](https://github.com/Adobe-CEP/CEP-Resources/blob/master/CEP_12.x/Documentation/Debugging%20Handbook.md) where After Effects searches for extensions, pointing to your development `dist` folder. That way no copy is necessary on every build.
- Modify the MainPath property of `CSXS\manifest.xml` depending on whether you're going to develop or distribute. This is the property that tells the Adobe CEP interpreter what file to open to render as the UI of the extension.
    - For development, MainPath points to `dev.html`. This file only contains a redirect to a localhost address where we can do hot reload using Vite/Svelte.
    - For packaging, change MainPath to `index.html`. This is the file generated by Vite/Svelte `npm_build` task. 
    **Important:** Since AE uses CEF to render the extension, but it is pulling it from a local file on the disk, we are subjected to Chrome's security rules. For this reason, we use the `vite-plugin-singlefile` in order to avoid loading files from a disk file.

### Important Files
#### CSXS/manifest.xml
This is the document that defines our extension. After Effects will scan the extensions folder and will recognize an extension by looking for any folder that contains `CSXS/manifest.xml`.

#### src/
Svelte source files. Mainly the files that have to do with UI/User Interaction.

- **App.svelte** Main entry point for our app.
- **lib/Messaging.mjs** Defines classes for communication between the UI and the CEP/ExtendScript side.
- **lib/AutomatorTypes** Contains the classes where the app stores its data.
- **lib: PropInput, ModalAlternate, Dropdown** Svelte UI components.

#### host/index.js
This is the ExtendScript side of our app. ExtendScript is based on ECMAScript 3 and is the language used by scripts to interact with Adobe applications. Our Svelte application can't access directly the methods of ExtendScript. For that, we need to call `__adobe_cep__.evalScript()`.